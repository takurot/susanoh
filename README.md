# Susanoh (ã‚¹ã‚µãƒãƒ²)

**AIé§†å‹•å‹ çµŒæ¸ˆåœé˜²è¡›ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ â€” ã‚²ãƒ¼ãƒ å†…ä¸æ­£å–å¼•ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§æ¤œçŸ¥ãƒ»éš”é›¢ãƒ»ç›£æŸ»**

Susanoh ã¯ã€ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚²ãƒ¼ãƒ çµŒæ¸ˆåœã«ãŠã‘ã‚‹RMTï¼ˆãƒªã‚¢ãƒ«ãƒãƒãƒ¼ãƒˆãƒ¬ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼‰ã€è³‡é‡‘æ´—æµ„ã€Botæ´»å‹•ãªã©ã®ä¸æ­£å–å¼•ã‚’ã€ã‚²ãƒ¼ãƒ ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®ã‚¤ãƒ™ãƒ³ãƒˆé€ä¿¡ã ã‘ã§å°å…¥ã§ãã‚‹é–‹ç™ºè€…å‘ã‘ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã§ã™ã€‚

---

## ä¸»ãªæ©Ÿèƒ½

- **ğŸ›¡ï¸ L1 é«˜é€Ÿãƒ«ãƒ¼ãƒ«åˆ¤å®š (Real-time Screening)**
  Redisã‚’ç”¨ã„ãŸã‚¹ãƒ©ã‚¤ãƒ‡ã‚£ãƒ³ã‚°ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«ã‚ˆã‚Šã€ã‚¤ãƒ™ãƒ³ãƒˆå—ä¿¡ã‹ã‚‰50msä»¥å†…ã«ä¸å¯©ãªå‹•ãã‚’æ¤œçŸ¥ã—ã€å³åº§ã«ä¸€æ¬¡å¯¾å¿œã‚’è¡Œã„ã¾ã™ã€‚

- **ğŸ§  L2 Gemini æ–‡è„ˆåˆ¤å®š (Contextual Analysis)**
  Google Gemini API ã‚’æ´»ç”¨ã—ã€ãƒãƒ£ãƒƒãƒˆãƒ­ã‚°ã‚„å–å¼•ãƒ‘ã‚¿ãƒ¼ãƒ³ã‹ã‚‰ã€Œãªãœä¸æ­£ã¨ç–‘ã‚ã‚Œã‚‹ã‹ã€ã®æ–‡è„ˆã‚’è§£æã€‚æ§‹é€ åŒ–ã•ã‚ŒãŸç›£æŸ»ãƒ¬ãƒãƒ¼ãƒˆï¼ˆåˆ¤å®šç†ç”±ï¼‰ã‚’æä¾›ã—ã¾ã™ã€‚

- **ğŸ¯ ãƒãƒ‹ãƒ¼ãƒãƒƒãƒˆåˆ¶å¾¡ (Dynamic State Machine)**
  ç–‘ã‚ã—ã„ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«å¯¾ã—ã€å³åº§ã«BANã™ã‚‹ã®ã§ã¯ãªãã€Œå‡ºé‡‘ã®ã¿ã‚’ãƒ–ãƒ­ãƒƒã‚¯ã€ã™ã‚‹ã‚¹ãƒ†ãƒ¼ãƒˆã¸é·ç§»ã€‚æ¥­è€…ã®æ´»å‹•ã‚’æ³³ãŒã›ã¤ã¤ã€çµŒæ¸ˆåœã‹ã‚‰ã®è³‡ç”£æµå‡ºã‚’ç¢ºå®Ÿã«é˜»æ­¢ã—ã¾ã™ã€‚

- **ğŸ“Š çµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ (Observability)**
  è³‡é‡‘ãƒ•ãƒ­ãƒ¼ã®å¯è¦–åŒ–ã‚°ãƒ©ãƒ•ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£æŸ»ãƒ­ã‚°ã€æ‰‹å‹•ä»‹å…¥ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å‚™ãˆãŸç®¡ç†ç”»é¢ã‚’æä¾›ã—ã¾ã™ã€‚

---

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

Susanoh ã¯ã€ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆå¯èƒ½ãªãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ã€‚

```mermaid
graph TD
    GameServer -->|HTTP/REST| APIGateway[FastAPI Gateway]
    APIGateway -->|Events| L1[L1 Screening Engine]
    L1 -->|State| Redis[(Redis State Store)]
    L1 -->|Async Task| Queue[Task Queue]
    Queue --> Worker[L2 Analysis Worker]
    Worker -->|Prompt| LLM[Gemini API]
    APIGateway -->|Logs| DB[(PostgreSQL)]
    Dashboard -->|Query| APIGateway
```

- **Backend**: FastAPI (Python)
- **Frontend**: React, TypeScript, Vite
- **Database**: PostgreSQL (User Profiles, Audit Logs)
- **State Store**: Redis (Session, Sliding Windows)
- **AI Engine**: Google Gemini API

---

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— (é–‹ç™ºç’°å¢ƒ)

### å‰ææ¡ä»¶

- Python 3.11+
- Node.js 18+
- PostgreSQL 15+ (ã¾ãŸã¯ Docker)
- Redis 7+ (ã¾ãŸã¯ Docker)
- Google AI Studio API Key

### 1. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰æ§‹ç¯‰

```bash
# ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³
git clone https://github.com/your-org/susanoh.git
cd susanoh

# ä»®æƒ³ç’°å¢ƒã®ä½œæˆã¨ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
python3 -m venv .venv
source .venv/bin/activate
pip install -r backend/requirements.txt

# ç’°å¢ƒå¤‰æ•°ã®è¨­å®š
export GEMINI_API_KEY=<your_api_key>
export DATABASE_URL=postgresql://user:pass@localhost:5432/susanoh
export REDIS_URL=redis://localhost:6379/0

# ã‚µãƒ¼ãƒãƒ¼èµ·å‹• (é–‹ç™ºãƒ¢ãƒ¼ãƒ‰)
uvicorn backend.main:app --host 0.0.0.0 --port 8000 --reload
```

### 2. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æ§‹ç¯‰

```bash
cd frontend
npm install

# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm run dev
```

ãƒ–ãƒ©ã‚¦ã‚¶ã§ `http://localhost:5173` ã‚’é–‹ãã€ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚

---

## API ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

ã™ã¹ã¦ã®APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ã¯ `X-API-KEY` ãƒ˜ãƒƒãƒ€ãƒ¼ãŒå¿…è¦ã§ã™ï¼ˆé–‹ç™ºãƒ¢ãƒ¼ãƒ‰ã§ã¯çœç•¥å¯ï¼‰ã€‚

| ãƒ¡ã‚½ãƒƒãƒ‰ | ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | èª¬æ˜ |
|---|---|---|
| `POST` | `/api/v1/events` | ã‚²ãƒ¼ãƒ ã‚¤ãƒ™ãƒ³ãƒˆå—ä¿¡ + L1ã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚° |
| `GET` | `/api/v1/users/{user_id}` | ãƒ¦ãƒ¼ã‚¶ãƒ¼çŠ¶æ…‹ç…§ä¼š |
| `POST` | `/api/v1/withdraw` | å‡ºé‡‘ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ˆã‚¹ãƒ†ãƒ¼ãƒˆã«åŸºã¥ãåˆ¶å¾¡ï¼‰ |
| `POST` | `/api/v1/users/{user_id}/release` | ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®æ‰‹å‹•ãƒ­ãƒƒã‚¯è§£é™¤ |
| `GET` | `/api/v1/stats` | çµ±è¨ˆãƒ¡ãƒˆãƒªã‚¯ã‚¹å–å¾— |
| `GET` | `/api/v1/graph` | è³‡é‡‘ãƒ•ãƒ­ãƒ¼ã‚°ãƒ©ãƒ•ãƒ‡ãƒ¼ã‚¿å–å¾— |
| `GET` | `/api/v1/analyses` | AIç›£æŸ»ãƒ¬ãƒãƒ¼ãƒˆä¸€è¦§ |

è©³ç´°ãªä»•æ§˜ã¯ [docs/SPEC.md](docs/SPEC.md) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

---

## é–‹ç™ºãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯ **Beta** ã§ã™ã€‚ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³é‹ç”¨ã«å‘ã‘ãŸãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ã¯ [docs/PLAN.md](docs/PLAN.md) ã§ç®¡ç†ã•ã‚Œã¦ã„ã¾ã™ã€‚

- [x] L1 ãƒ«ãƒ¼ãƒ«ã‚¨ãƒ³ã‚¸ãƒ³ & ã‚¹ãƒ†ãƒ¼ãƒˆãƒã‚·ãƒ³
- [x] L2 Gemini åˆ†æçµ±åˆ
- [x] ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
- [ ] PostgreSQL æ°¸ç¶šåŒ– (Phase 1)
- [ ] èªè¨¼ãƒ»èªå¯åŸºç›¤ (Phase 1)
- [ ] CI/CD & Docker (Phase 2)

---

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

[MIT License](LICENSE)
